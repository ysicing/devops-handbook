"use strict";(self.webpackChunkblog=self.webpackChunkblog||[]).push([[8308],{3905:function(e,n,t){t.d(n,{Zo:function(){return s},kt:function(){return g}});var r=t(67294);function l(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function a(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,r)}return t}function o(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?a(Object(t),!0).forEach((function(n){l(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):a(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function u(e,n){if(null==e)return{};var t,r,l=function(e,n){if(null==e)return{};var t,r,l={},a=Object.keys(e);for(r=0;r<a.length;r++)t=a[r],n.indexOf(t)>=0||(l[t]=e[t]);return l}(e,n);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(r=0;r<a.length;r++)t=a[r],n.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(l[t]=e[t])}return l}var i=r.createContext({}),k=function(e){var n=r.useContext(i),t=n;return e&&(t="function"==typeof e?e(n):o(o({},n),e)),t},s=function(e){var n=k(e.components);return r.createElement(i.Provider,{value:n},e.children)},c={inlineCode:"code",wrapper:function(e){var n=e.children;return r.createElement(r.Fragment,{},n)}},p=r.forwardRef((function(e,n){var t=e.components,l=e.mdxType,a=e.originalType,i=e.parentName,s=u(e,["components","mdxType","originalType","parentName"]),p=k(t),g=l,m=p["".concat(i,".").concat(g)]||p[g]||c[g]||a;return t?r.createElement(m,o(o({ref:n},s),{},{components:t})):r.createElement(m,o({ref:n},s))}));function g(e,n){var t=arguments,l=n&&n.mdxType;if("string"==typeof e||l){var a=t.length,o=new Array(a);o[0]=p;var u={};for(var i in n)hasOwnProperty.call(n,i)&&(u[i]=n[i]);u.originalType=e,u.mdxType="string"==typeof e?e:l,o[1]=u;for(var k=2;k<a;k++)o[k]=t[k];return r.createElement.apply(null,o)}return r.createElement.apply(null,t)}p.displayName="MDXCreateElement"},40867:function(e,n,t){t.r(n),t.d(n,{assets:function(){return s},contentTitle:function(){return i},default:function(){return g},frontMatter:function(){return u},metadata:function(){return k},toc:function(){return c}});var r=t(83117),l=t(80102),a=(t(67294),t(3905)),o=["components"],u={title:"kubectl plugin\u63d2\u4ef6\u673a\u5236\u521d\u4f53\u9a8c\u4e4bkrew",date:new Date("2020-05-18T14:55:18.000Z"),description:"kubectl plugin\u63d2\u4ef6\u673a\u5236\u521d\u4f53\u9a8c\u4e4bkrew",tags:["krew","kubernetes"]},i=void 0,k={permalink:"/posts/k8s-kubectl-plugins",source:"@site/blog/posts/k8s-kubectl-plugins.md",title:"kubectl plugin\u63d2\u4ef6\u673a\u5236\u521d\u4f53\u9a8c\u4e4bkrew",description:"kubectl plugin\u63d2\u4ef6\u673a\u5236\u521d\u4f53\u9a8c\u4e4bkrew",date:"2020-05-18T14:55:18.000Z",formattedDate:"2020\u5e745\u670818\u65e5",tags:[{label:"krew",permalink:"/tags/krew"},{label:"kubernetes",permalink:"/tags/kubernetes"}],readingTime:1.46,hasTruncateMarker:!0,authors:[],frontMatter:{title:"kubectl plugin\u63d2\u4ef6\u673a\u5236\u521d\u4f53\u9a8c\u4e4bkrew",date:"2020-05-18T14:55:18.000Z",description:"kubectl plugin\u63d2\u4ef6\u673a\u5236\u521d\u4f53\u9a8c\u4e4bkrew",tags:["krew","kubernetes"]},prevItem:{title:"k8s\u5b9e\u8df5\u4e4b\u90e8\u7f72\u7b2c\u4e00\u4e2a\u5e94\u7528",permalink:"/posts/k8s-intro-deploy"},nextItem:{title:"k8s\u6807\u7b7e\u548c\u9009\u62e9\u5668",permalink:"/posts/k8s-labels"}},s={authorsImageUrls:[]},c=[{value:"kubectl plugin\u63d2\u4ef6\u673a\u5236\u521d\u4f53\u9a8c\u4e4bkrew",id:"kubectl-plugin\u63d2\u4ef6\u673a\u5236\u521d\u4f53\u9a8c\u4e4bkrew",level:2},{value:"\u63d2\u4ef6\u673a\u5236",id:"\u63d2\u4ef6\u673a\u5236",level:3},{value:"\u5b98\u65b9\u793a\u4f8b",id:"\u5b98\u65b9\u793a\u4f8b",level:4},{value:"\u793a\u4f8b\u63d2\u4ef6",id:"\u793a\u4f8b\u63d2\u4ef6",level:4},{value:"krew",id:"krew",level:3},{value:"\u5b89\u88c5krew",id:"\u5b89\u88c5krew",level:4},{value:"krew\u4f7f\u7528",id:"krew\u4f7f\u7528",level:4},{value:"\u521d\u4f53\u9a8c",id:"\u521d\u4f53\u9a8c",level:4}],p={toc:c};function g(e){var n=e.components,t=(0,l.Z)(e,o);return(0,a.kt)("wrapper",(0,r.Z)({},p,t,{components:n,mdxType:"MDXLayout"}),(0,a.kt)("h2",{id:"kubectl-plugin\u63d2\u4ef6\u673a\u5236\u521d\u4f53\u9a8c\u4e4bkrew"},"kubectl plugin\u63d2\u4ef6\u673a\u5236\u521d\u4f53\u9a8c\u4e4bkrew"),(0,a.kt)("h3",{id:"\u63d2\u4ef6\u673a\u5236"},"\u63d2\u4ef6\u673a\u5236"),(0,a.kt)("p",null,"\u8fd9\u4e2a\u65e9\u5c31\u5df2\u7ecfGA\u4e86\uff0c\u5176\u4f5c\u7528\u5141\u8bb8\u5f00\u53d1\u8005\u4ee5\u72ec\u7acb\u7684\u4e8c\u8fdb\u5236\u6216\u811a\u672c\u5f62\u5f0f\u53d1\u5e03\u81ea\u5b9a\u4e49\u7684kubectl\u5b50\u547d\u4ee4, \u7075\u6d3b\u5feb\u901f\u64cd\u4f5ck8s"),(0,a.kt)("p",null,"\u63d2\u4ef6\u4e0d\u9650\u5236\u8bed\u8a00\uff0c\u53ea\u9700\u5c06\u811a\u672c\u6216\u4e8c\u8fdb\u5236\u53ef\u6267\u884c\u6587\u4ef6\u4ee5",(0,a.kt)("inlineCode",{parentName:"p"},"kubectl-<plugin-name>"),"\u7684\u524d\u7f00\u653e\u5230PATH\u4e2d\u5373\u53ef."),(0,a.kt)("h4",{id:"\u5b98\u65b9\u793a\u4f8b"},"\u5b98\u65b9\u793a\u4f8b"),(0,a.kt)("p",null,"\u5b98\u65b9Go\u793a\u4f8b\u8f85\u52a9\u5e93 ",(0,a.kt)("a",{parentName:"p",href:"https://github.com/kubernetes/cli-runtime.git"},"https://github.com/kubernetes/cli-runtime.git")),(0,a.kt)("p",null,"\u4e0d\u592a\u7b80\u5355\u7684\u5b98\u65b9\u793a\u4f8b\u63d2\u4ef6 ",(0,a.kt)("a",{parentName:"p",href:"https://github.com/kubernetes/sample-cli-plugin"},"https://github.com/kubernetes/sample-cli-plugin")),(0,a.kt)("h4",{id:"\u793a\u4f8b\u63d2\u4ef6"},"\u793a\u4f8b\u63d2\u4ef6"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre"},"mkdir /usr/local/k8s\nexport PATH=$PATH:/usr/local/k8s\n")),(0,a.kt)("p",null,"\u793a\u4f8b\u63d2\u4ef6\u5982\u4e0b\uff1a"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre"},"root@k8s1:~# cat /usr/local/k8s/kubectl-demo\n#!/bin/bash\n\necho $1\n")),(0,a.kt)("p",null,"\u8d4b\u4e88\u6267\u884c\u6743\u9650 "),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre"},"chmod +x /usr/local/k8s/kubectl-demo\n")),(0,a.kt)("p",null,"\u8fd0\u884c\u6d4b\u8bd5:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre"},"root@k8s1:~# kubectl demo 666\n666\n\nroot@k8s1:~# kubectl plugin list\nThe following compatible plugins are available:\n\n/usr/local/k8s/kubectl-demo\n")),(0,a.kt)("p",null,(0,a.kt)("inlineCode",{parentName:"p"},"kubectl plugin list")," \u53ef\u4ee5\u67e5\u770bPATH\u4e2d\u67e5\u770b\u6709\u54ea\u4e9b\u63d2\u4ef6"),(0,a.kt)("h3",{id:"krew"},"krew"),(0,a.kt)("p",null,"Package manager for kubectl plugins -- ",(0,a.kt)("a",{parentName:"p",href:"https://krew.dev"},"krew")),(0,a.kt)("h4",{id:"\u5b89\u88c5krew"},"\u5b89\u88c5krew"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre"},'# Bash and ZSH\n\n(\n  set -x; cd "$(mktemp -d)" &&\n  curl -fsSLO "https://github.com/kubernetes-sigs/krew/releases/download/v0.3.4/krew.{tar.gz,yaml}" &&\n  tar zxvf krew.tar.gz &&\n  KREW=./krew-linux_amd64 &&\n  "$KREW" install --manifest=krew.yaml --archive=krew.tar.gz &&\n  "$KREW" update\n)\n\n# .bashrc/.zshrc\nexport PATH=$PATH:/usr/local/k8s:${KREW_ROOT:-$HOME/.krew}/bin\n')),(0,a.kt)("p",null,"\u67e5\u770b\u5f53\u524d\u53ef\u7528\u7684kubectl plugin\uff0c\u53d1\u73b0\u591a\u4e86\u4e00\u4e2akubect-krew"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre"},"root@k8s1:~# kubectl plugin list\nThe following compatible plugins are available:\n\n/usr/local/k8s/kubectl-demo\n/root/.krew/bin/kubectl-krew\n")),(0,a.kt)("h4",{id:"krew\u4f7f\u7528"},"krew\u4f7f\u7528"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre"},'kubectl krew\nkrew is the kubectl plugin manager.\nYou can invoke krew through kubectl: "kubectl krew [command]..."\n\nUsage:\n  krew [command]\n\nAvailable Commands:\n  help        Help about any command\n  info        Show information about a kubectl plugin\n  install     Install kubectl plugins\n  list        List installed kubectl plugins\n  search      Discover kubectl plugins\n  uninstall   Uninstall plugins\n  update      Update the local copy of the plugin index\n  upgrade     Upgrade installed plugins to newer versions\n  version     Show krew version and diagnostics\n\nFlags:\n  -h, --help      help for krew\n  -v, --v Level   number for the log level verbosity\n\nUse "krew [command] --help" for more information about a command.\n')),(0,a.kt)("h4",{id:"\u521d\u4f53\u9a8c"},"\u521d\u4f53\u9a8c"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre"},'root@k8s1:~# kubectl get pods\nNo resources found in default namespace.\nroot@k8s1:~# kubectl krew install change-ns\nInstalling plugin: change-ns\nInstalled plugin: change-ns\nroot@k8s1:~# kubectl krew list\nPLUGIN     VERSION\nchange-ns  v1.0.0\nkrew       v0.3.3\nroot@k8s1:~# kubectl change-ns nginx-ingress\nnamespace changed to "nginx-ingress"\nroot@k8s1:~# kubectl get pod\nroot@k8s1:~#  kubectl get pod\nNAME                  READY   STATUS              RESTARTS   AGE\nnginx-ingress-rfswh   1/1     Running             0          2m6s\nnginx-ingress-v6c4l   1/1     Running             0          2m6s\n')))}g.isMDXComponent=!0}}]);